{{ define "main" }} {{ $data := index .Site.Data .Site.Language.Lang }}

<!-- Page Header -->
<section class="hero" style="padding: var(--space-16) 0">
  <div class="hero-grid"></div>
  <div class="container">
    <div class="hero-content">
      <span class="hero-badge">
        <i class="ri-apps-2-line"></i>
        DSC Modules
      </span>
      <h1 class="hero-title">Resource Modules</h1>
      <p class="hero-description">
        Explore the collection of DSC resource modules maintained by the
        community. Each module helps you manage configurations across your
        infrastructure.
      </p>

      <!-- Search -->
      <div class="hero-search">
        <svg
          class="hero-search-icon"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="11" cy="11" r="8" />
          <path d="m21 21-4.3-4.3" />
        </svg>
        <input
          type="text"
          id="resourceSearch"
          placeholder="Search modules..."
          oninput="filterResources(this.value)"
        />
      </div>
    </div>
  </div>
</section>

<!-- Quick Stats -->
<section class="section section-alt" style="padding: var(--space-8) 0">
  <div class="container">
    <div class="stats">
      <div class="stat">
        <span class="stat-value">{{ len $data.resources }}</span>
        <span class="stat-label">Resource Modules</span>
      </div>
      <div class="stat">
        <span class="stat-value">1M+</span>
        <span class="stat-label">Total Downloads</span>
      </div>
      <div class="stat">
        <span class="stat-value">100+</span>
        <span class="stat-label">Contributors</span>
      </div>
      <div class="stat">
        <span class="stat-value">MIT</span>
        <span class="stat-label">License</span>
      </div>
    </div>
  </div>
</section>

<!-- Resources Grid -->
<section class="section">
  <div class="container">
    <div class="grid-auto" id="resourceGrid">
      {{ range $data.resources }}
      <div
        class="card resource-card"
        data-name="{{ .Name | lower }}"
        data-tags="{{ .AdditionalMetadata.tags | lower }}"
      >
        <div
          style="
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: var(--space-3);
          "
        >
          <div class="card-icon" style="margin-bottom: 0">
            <i class="ri-box-3-line"></i>
          </div>
          <span
            class="badge badge-success"
            style="
              background: rgba(16, 185, 129, 0.1);
              color: var(--color-success);
              padding: var(--space-1) var(--space-2);
              border-radius: var(--radius-sm);
              font-size: var(--text-xs);
            "
          >
            v{{ .Version }}
          </span>
        </div>

        <h3 class="card-title" style="margin-bottom: var(--space-2)">
          {{ .Name }}
        </h3>

        <p
          class="card-description"
          style="font-size: var(--text-sm); margin-bottom: var(--space-4)"
        >
          {{ .Description | truncate 150 }}
        </p>

        <!-- Tags -->
        {{ with .AdditionalMetadata.tags }}
        <div
          style="
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-1);
            margin-bottom: var(--space-4);
          "
        >
          {{ range first 4 (split . " ") }} {{ if . }}
          <span class="tag" style="font-size: 10px; padding: 2px 6px"
            >{{ . }}</span
          >
          {{ end }} {{ end }}
        </div>
        {{ end }}

        <!-- DSC Resources Count -->
        {{ with .AdditionalMetadata.DscResources }}
        <p
          style="
            font-size: var(--text-xs);
            color: var(--text-tertiary);
            margin-bottom: var(--space-3);
          "
        >
          <i class="ri-stack-line"></i> {{ len (split . " ") }} resources
        </p>
        {{ end }}

        <!-- Actions -->
        <div style="display: flex; gap: var(--space-2); margin-top: auto">
          <a
            href="{{ .ProjectUri }}"
            class="btn btn-sm btn-outline"
            target="_blank"
            rel="noopener noreferrer"
            style="flex: 1; justify-content: center"
          >
            <i class="ri-github-line"></i>
            GitHub
          </a>
          <a
            href="https://www.powershellgallery.com/packages/{{ .Name }}"
            class="btn btn-sm btn-primary"
            target="_blank"
            rel="noopener noreferrer"
            style="flex: 1; justify-content: center"
          >
            <i class="ri-download-line"></i>
            Install
          </a>
        </div>
      </div>
      {{ end }}
    </div>

    <!-- No Results Message -->
    <div
      id="noResults"
      style="display: none; text-align: center; padding: var(--space-12)"
    >
      <i
        class="ri-search-line"
        style="font-size: 3rem; color: var(--text-tertiary)"
      ></i>
      <h3 style="margin-top: var(--space-4)">No modules found</h3>
      <p style="color: var(--text-secondary)">
        Try adjusting your search terms.
      </p>
    </div>
  </div>
</section>

<!-- CTA Section -->
<section class="section section-alt">
  <div class="container">
    <div class="cta">
      <div class="cta-content">
        <h2 class="cta-title">Want to Contribute?</h2>
        <p class="cta-description">
          Help us improve these modules! Check out our contributing guidelines
          to get started.
        </p>
        <div class="flex justify-center gap-4">
          <a href="/guidelines/contributing" class="btn btn-primary btn-lg">
            <i class="ri-git-branch-line"></i>
            Contributing Guide
          </a>
          <a
            href="https://github.com/dsccommunity"
            class="btn btn-secondary btn-lg"
            target="_blank"
            rel="noopener noreferrer"
          >
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
              />
            </svg>
            View All Repos
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Filter Script -->
<script>
  function filterResources(query) {
    const grid = document.getElementById("resourceGrid");
    const cards = grid.querySelectorAll(".resource-card");
    const noResults = document.getElementById("noResults");
    const searchTerm = query.toLowerCase().trim();
    let visibleCount = 0;

    cards.forEach((card) => {
      const name = card.dataset.name || "";
      const tags = card.dataset.tags || "";

      if (
        !searchTerm ||
        name.includes(searchTerm) ||
        tags.includes(searchTerm)
      ) {
        card.style.display = "";
        visibleCount++;
      } else {
        card.style.display = "none";
      }
    });

    noResults.style.display = visibleCount === 0 ? "block" : "none";
  }
</script>

{{ end }}
